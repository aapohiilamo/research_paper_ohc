"0","#| label: fig-ohc-by-age"
"0","#| fig-cap: Out-of-home care placements in Finland 1992 - 2021. Sotkanet data."
"0","#| warning: false "
"0",""
"0",""
"0","all <- c(""ohc"", ""year"", ""region"",""gender"", ""region.class"", ""poverty"" , ""childr0018_n"", ""unemp"")"
"0","all <- dsw.d[all]"
"0",""
"0","all <- rename(all,  "
"0","                  ohc_age = ""ohc"","
"0","                  child_n_age = ""childr0018_n"")"
"0",""
"0","all$age.group <- ""Ages 0 - 17""       "
"0","all$a.group <- ""All""  "
"0",""
"0","preteen <- c(""ohc0012"", ""year"", ""region"",""gender"", ""region.class"", ""poverty"" , ""childr0012_n"", ""unemp"")"
"0","preteen <- dsw.d[preteen]"
"0",""
"0","preteen <- rename(preteen,  "
"0","                  ohc_age = ""ohc0012"","
"0","                  child_n_age = ""childr0012_n"")"
"0",""
"0","preteen$age.group <- ""Ages 0 - 12""          "
"0","preteen$a.group <- ""By age group""  "
"0",""
"0","teen <- c(""ohc1317"", ""year"", ""region"" , ""gender"", ""region.class"", ""poverty"" , ""childr1317_n"", ""unemp"")"
"0",""
"0","teen <- dsw.d[teen]"
"0",""
"0","teen <- rename(teen,  ohc_age = ""ohc1317"","
"0","                  child_n_age = ""childr1317_n"")"
"0",""
"0","teen$age.group <- ""Ages 13 - 17""              "
"0","teen$a.group <- ""By age group""  "
"0","teens <-  rbind(teen,preteen, all)"
"0",""
"0","teens_maa <- filter(teens, region.class == ""MAA"")"
"0","teens_kunta <- filter(teens, region.class == ""KUNTA"")"
"0",""
"0",""
"0","#by gender"
"0","ggplot(data = filter(teens, region.class == ""MAA""),"
"0","       aes("
"0","    x = year, y = ohc_age)) +"
"0","geom_text(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(year)) %>% "
"0","              slice(1, 2), "
"0","            aes(label=round(ohc_age, digits = 0)), "
"0","            position=position_nudge(y = 1.5, x = -1), hjust=0, show.legend=FALSE) + "
"0","   geom_text(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(year)) %>% "
"0","              slice(1, 3), "
"0","            aes(label=round(ohc_age, digits = 0)), "
"0","            position=position_nudge(y = 1.5, x = -1), hjust=0, show.legend=FALSE) + "
"0","  geom_text(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(-year)) %>% "
"0","              slice(1), "
"0","            aes(label=round(ohc_age, digits = 0)), "
"0","            position=position_nudge(y = 1.5, x = -1), hjust=0, show.legend=FALSE)  +  "
"0","     geom_text(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(-year)) %>% "
"0","              slice(1, 3), "
"0","            aes(label=round(ohc_age, digits = 0)), "
"0","            position=position_nudge(y = 1.5, x = -1), hjust=0, show.legend=FALSE)  +  "
"0","   facet_grid(cols = vars(gender)) +   "
"0","   geom_point(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(year)) %>% "
"0","              slice(1, 2), size = 3) + "
"0","      geom_point(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(year)) %>% "
"0","              slice(1, 3), size = 3) + "
"0","   geom_point(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(-year)) %>% "
"0","              slice(1, 2), size = 3) +"
"0","      geom_point(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(-year)) %>% "
"0","              slice(1, 3), size = 3) +"
"0","  geom_text(data=. %>% "
"0","                 group_by(gender) %>% "
"0","              arrange(desc(-year)) %>% "
"0","              slice(2), "
"0","            aes(label=round(ohc_age, digits = 0)), "
"0","            position=position_nudge(y = 0, x = -2.5), hjust=0, show.legend=FALSE) +  "
"0","     geom_textline( data = filter(teens, region.class == ""MAA""),aes("
"0","    x = year, y = ohc_age, group = age.group, label = age.group  ),  size = 4,"
"0","  linewidth = 1,"
"0","  hjust = 0.5"
"0","  ) + "
"0","   ylab(""Out-of-home care per 1000 children"") +"
"0","  scale_y_continuous(limits=c(0,30))"
